import{a as F,c as L,o as R,q as H,w as D,x as z,y as K}from"./chunk-J24RPUX3.js";import{Ab as v,Cb as h,Db as m,Ic as O,Jb as C,Kb as S,Lb as I,Mb as Q,Nb as c,Ob as A,Pb as k,Pc as V,Qb as M,Rb as q,Sb as E,Tb as P,Vb as T,Vc as N,X as g,Xa as a,Xc as B,Ya as u,aa as x,ad as U,dc as j,e as J,ga as w,id as W,mb as b,ob as d,pb as y,qa as l,ra as p,vb as r,wb as s,xb as _}from"./chunk-XQ2V4OED.js";var f=J(K());var Y=(()=>{class i{constructor(e){this.http=e,this.apiUrl=D.baseUrl}getAuthHeaders(){let t={Authorization:`Bearer ${sessionStorage.getItem("token")}`,"Content-Type":"application/json","ngrok-skip-browser-warning":"true"};return new F(t)}submitAnswers(e){return this.http.post(`${this.apiUrl}/api/Accounts/UpdateAnswers`,e,{headers:this.getAuthHeaders()})}getAnswers(){return this.http.get(`${this.apiUrl}/api/Accounts/GetAnswers`,{headers:this.getAuthHeaders()})}static{this.\u0275fac=function(t){return new(t||i)(x(L))}}static{this.\u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ee=["answerInput"];function te(i,G){i&1&&(r(0,"div",3)(1,"div",4)(2,"span",5),c(3,"Loading..."),s()(),r(4,"p",6),c(5,"Loading your health information..."),s()())}function ie(i,G){if(i&1){let e=v();r(0,"div",7)(1,"div",8),_(2,"div",9),s(),r(3,"h5",10),c(4),s(),r(5,"h4",11),c(6),s(),r(7,"textarea",12),P("ngModelChange",function(n){l(e);let o=m();return E(o.currentAnswer,n)||(o.currentAnswer=n),p(n)}),s(),r(8,"div",13)(9,"button",14),h("click",function(){l(e);let n=m();return p(n.onSkip())}),c(10," Skip "),s(),r(11,"button",15),h("click",function(){l(e);let n=m();return p(n.onNext())}),c(12),s()()()}if(i&2){let e=m();a(2),y("width",(e.currentQuestionIndex+1)/e.questions.length*100,"%"),a(2),M(" Question ",e.currentQuestionIndex+1," of ",e.questions.length," "),a(2),A(e.currentQuestion.text),a(),q("ngModel",e.currentAnswer),d("disabled",e.isSubmitted),a(2),d("disabled",e.isSubmitted),a(2),d("disabled",e.isSubmitted),a(),k(" ",e.isLastQuestion?"Submit":"Next",`
`)}}var le=(()=>{class i{constructor(e,t,n,o){this.questionsService=e,this.router=t,this.route=n,this.authService=o,this.currentQuestionIndex=0,this.answers={},this.isSubmitted=!1,this.isLoading=!1,this.email="",this.currentAnswer="",this.questions=[{id:"promptReason",text:"1.What is your main reason for seeking medical advice today?",required:!1,apiField:"promptReason"},{id:"chronicConditions",text:"2. Do you have any chronic or recurring health conditions?",required:!1,apiField:"hasChronicConditions"},{id:"conditionsImpact",text:"3. Are you currently taking any medications or treatments?",required:!1,apiField:"takesMedicationsOrTreatments"},{id:"currentSymptoms",text:"4. What symptoms are you currently experiencing?",required:!1,apiField:"currentSymptoms"}],this.route.queryParams.subscribe($=>{this.email=$.email})}ngAfterViewInit(){this.answerInput&&this.answerInput.nativeElement.focus()}get currentQuestion(){return this.questions[this.currentQuestionIndex]}get isLastQuestion(){return this.currentQuestionIndex===this.questions.length-1}onNext(){let e=this.currentAnswer.trim();this.answers[this.currentQuestion.id]=e,this.currentAnswer="",this.isLastQuestion?this.submitAnswers():this.currentQuestionIndex++}onSkip(){this.answers[this.currentQuestion.id]="",this.currentAnswer="",this.isLastQuestion?this.submitAnswers():this.currentQuestionIndex++}submitAnswers(){this.isSubmitted=!0;let e={PromptReason:this.answers.promptReason||"",HasChronicConditions:this.answers.chronicConditions||"",TakesMedicationsOrTreatments:this.answers.conditionsImpact||"",CurrentSymptoms:this.answers.currentSymptoms||""};this.questionsService.submitAnswers(e).subscribe({next:()=>{f.default.fire({icon:"success",title:"Your answers have been submitted successfully!",showConfirmButton:!0}).then(()=>{this.router.navigate(["/main/profile"])})},error:t=>{console.error("submitAnswers error:",t),f.default.fire("Error","Failed to submit answers. Please try again.","error"),this.isSubmitted=!1}})}static{this.\u0275fac=function(t){return new(t||i)(u(Y),u(H),u(R),u(z))}}static{this.\u0275cmp=w({type:i,selectors:[["app-questions"]],viewQuery:function(t,n){if(t&1&&C(ee,5),t&2){let o;S(o=I())&&(n.answerInput=o.first)}},standalone:!0,features:[T],decls:4,vars:2,consts:[["questionBlock",""],[1,"d-flex","justify-content-center","align-items-center","min-vh-100","bg-light","px-3"],["class","text-center p-4 card","style","max-width: 600px;",4,"ngIf","ngIfElse"],[1,"text-center","p-4","card",2,"max-width","600px"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-3","mb-0"],[1,"card","shadow-lg","p-4","w-100",2,"max-width","600px"],[1,"progress","mb-4",2,"height","6px"],[1,"progress-bar","bg-success"],[1,"mb-3","fw-semibold","text-primary"],[1,"mb-4"],["rows","5","placeholder","Type your answer here...",1,"form-control","mb-3",2,"resize","none",3,"ngModelChange","ngModel","disabled"],[1,"d-flex","justify-content-between"],[1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"btn","btn-primary",3,"click","disabled"]],template:function(t,n){if(t&1&&(r(0,"div",1),b(1,te,6,0,"div",2)(2,ie,13,10,"ng-template",null,0,j),s()),t&2){let o=Q(3);a(),d("ngIf",n.isLoading)("ngIfElse",o)}},dependencies:[V,O,W,N,B,U],styles:["textarea.form-control[_ngcontent-%COMP%]{resize:none;transition:box-shadow .2s ease;border-radius:.75rem}textarea[_ngcontent-%COMP%]:focus{box-shadow:0 0 8px #007bff66;border-color:#80bdff}.card[_ngcontent-%COMP%]{transition:transform .2s ease,box-shadow .2s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 20px #00000014}button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}button[_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.03)}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;margin:0;padding:0}"]})}}return i})();export{le as QuestionsComponent};
